---
title: 'Stat 579 - Homework #4 - Section A'
date: "9/26/2019"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Behavioral Risk Factor Surveillance System - Again

We are again looking at the data from the
Behavioral Risk Factor Surveillance System (BRFSS).

A subset of the data concentrating on Iowa with records for 2016 is given at
```{r}
url <- "https://raw.githubusercontent.com/Stat579-at-ISU/stat579-at-isu.github.io/master/homework/data/brfss-iowa-2018.csv"
```

The following code reads the data into your R session:
```{r, warning = FALSE}
iowa <- read.csv(url)
library(dplyr)
library(tidyverse)
library(ggplot2)
```

A codebook describing the survey and a listing of all variables is available at [https://www.cdc.gov/brfss/annual_data/2017/pdf/codebook17_llcp-v2-508.pdf]().

For each of the questions, show the code necessary to get to the answer. 
Make sure to also write the answer to the question in a sentence.

1. Download the RMarkdown file with these homework instructions to use as a template for your work.
Make sure to replace "Your Name" in the YAML with your name.
2. Load the dataset into your session and store it in the object `iowa`.

As already seen in the last homework, the coding scheme used for HEIGHT3 is:

| HEIGHT3 value  |  Interpretation    |
|:- |:- |
| 200 - 711 | Height (ft/inches), i.e. 410 is 4 feet, 10 inches	|
| 7777 |	Don't know/Not sure	|
| 9000 - 9998 |	Height (meters/centimeters), where the first 9 indicates that the measurement was metric, 9165 is 1 meter 65 cm |
| 9999	| Refused |
| BLANK |	Not asked or Missing |

The overall goal is to introduce a new variable `height` that corresponds to reported height in centimeters [cm].

3. Sketch out a way to derive a new variable `height` that represents the values in `HEIGHT3` in centimeters and properly encodes any unavailable information as missing values (`NA`).
Implement your transformation. For your convenience: 1 ft equals 30.48 cm, 1 inch equals 2.54 cm. 1 m equals 100 cm.

We want to convert values represented in the U.S. standard measurement system by extracting the inches and feet separately. Then we want to remove the labeling (thousands-digit) on values 9000 to 9998 to obtain exact metric measurements in centimeters, and lastly disregard other values. 
```{r}
iowa <- iowa %>% 
          mutate(height = ifelse(HEIGHT3 <= 711 & HEIGHT3 >= 200, HEIGHT3 %/% 100 * 30.48 + HEIGHT3 %% 100 * 2.54, ifelse(HEIGHT3 >= 9000 & HEIGHT3 < 9999, HEIGHT3 %% 1000, NA)))
```

4. How  many missing values does the variable `height` have? 
```{r}
sum(is.na(iowa$height))
```
The variable `height` has 252 missing values.

5. What is the average height among respondents of the survey? among men? among women? Does the result make sense? Comment.
```{r}
mean(iowa$height, na.rm = TRUE)
menIowa <- iowa %>% 
  filter(SEX1 == 1)
mean(menIowa$height, na.rm = TRUE)
womenIowa <- iowa %>% 
  filter(SEX1 == 2)
mean(womenIowa$height, na.rm = TRUE)
```
The average height among respondents is 171.2275 cm. Among men, the average height was 178.8205 cm and among women the average was 164.2754 cm. The results make sense because women tend to be shorter due to a human's biological makeup and taking the average over all men and women gives an average between the men's and women's average heights.

6. Plot a histogram of `height`, facet by gender such that the histograms are on top of each other. Choose an appropriate bin width and comment on the resulting plot. 
```{r}
iowa %>% 
  filter(SEX1 == 1 | SEX1 == 2) %>% 
  ggplot(aes(x = height)) +
  geom_histogram(binwidth = 5) +
  xlab('Height (cm)') +
  facet_grid(rows = vars(SEX1))
```  

Note that we removed data for rows where `SEX1` equaled 7 or 9 since we only wanted to compare `height` data on men and women. Looking at the histograms, we can see the variance in the distribution for both genders is visually similar. Though for women, the distribution is centered about a lower mean than the men. We can also see the largest and the lowest value of `height` is taken by men. It is interesting that there is data reported for men that have height between 90 and 120cm whereas women do not have any reported data in this range.

7. The variable `WTKG3` has measurements of weight in 10s of grams (i.e. `WTKG3` divided by 100 gives the weight in kilogram). 
```{r}
iowa$WTKG3 <- iowa$WTKG3 / 100
```
8. Use `ggplot2` to draw a scatterplot of weight (`WTKG3`) by height (new `height` variable). Facet by gender and comment.
```{r}
iowa %>% 
  filter(SEX1 == 1 | SEX1 == 2) %>% 
  ggplot(aes(x = WTKG3, y = height)) + 
  geom_point() +
  facet_wrap(~SEX1) +
  xlab('Weight (Kg)') +
  ylab('Height (cm)')
```

From the scatterplot, we can see there seems to be a slight positive correlation between one's weight and height for both men and women. Though the large spread in weights across different heights makes it difficult to conclude a strong correlation. We can also see that for women, the weights were in general lower than the weights of the men for a given height. Most of the extreme upper values of weights were measured from men and the extreme lower values of weights from women. There are several outliers in terms of `height`. For men, there were extreme cases where the men measured to be below 120cm had a weight similar to men with heights generally at 150+ cm. Outliers in terms of `weight` can also be observed from both genders as points seen on the rightmost areas of the plot indicate having a relatively large weight compared to others that reported a similar height.

Due date: the homework is due a week from now on Thursday. 

For the submission: submit your solution in an R Markdown file and (just for insurance) submit the corresponding html/word file with it. 
