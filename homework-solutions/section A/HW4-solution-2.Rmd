---
title: 'Stat 579 - Homework #4 - Section A'
date: "9/26/2019"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, cache = TRUE, warning = FALSE}
url <- "https://raw.githubusercontent.com/Stat579-at-ISU/stat579-at-isu.github.io/master/homework/data/brfss-iowa-2018.csv"

iowa <- read.csv(url)
library(tidyverse)
```

### 3. Sketch out a way to derive a new variable `height` that represents the values in `HEIGHT3` in centimeters and properly encodes any unavailable information as missing values (`NA`).

```{r, cache = TRUE, warning = FALSE}
iowa <- iowa %>% 
  mutate(
    height = ifelse(HEIGHT3 <= 711, 30.48*floor(HEIGHT3/100)+2.54*(HEIGHT3-100*floor(HEIGHT3/100)), ifelse(HEIGHT3 %in% 9000:9998, HEIGHT3-floor(HEIGHT3/1000)*1000, NA))
  )

    summary(iowa$height)

```

### 4. How  many missing values does the variable `height` have? 

```{r, cache = TRUE, warning = FALSE}
sum(is.na(iowa$height))

```


### 5. What is the average height among respondents of the survey? among men? among women? Does the result make sense? Comment.
The result seems to make sense. The total mean height is 171.23, the mean height of men is 178.82, and the mean of women is 164.27. Google lists the male and female averages as 175.4 and 161.5, which are pretty close to our sample. Without having any additional information on the types of people that may refuse/fail to answer, I can't really comment on those averages.

```{r, cache = TRUE, warning = FALSE}
iowa %>% 
  summarize(mean_height = mean(height, na.rm=TRUE))

iowa %>%
  group_by(SEX1) %>% 
  summarise(mean_height = mean(height, na.rm=TRUE))

```


### 6. Plot a histogram of `height`, facet by gender such that the histograms are on top of each other. Choose an appropriate bin width and comment on the resulting plot. 
Both distributions appear to be somewhat centered around their means with the male distribution appearing quite bell-shaped. I think that the histograms make it quite clear that the populations of men and women have different mean heights. Also, I removed SEX1=OR(7,9) because they were so infrequent that the binwidth couldn't capture them.

```{r, cache = TRUE, warning = FALSE}
library(dplyr)

iowa %>% 
  filter(SEX1 %in% 1:2) %>%
  ggplot(aes(x = height)) + 
  geom_histogram(binwidth = 5) + 
  facet_grid(SEX1~.)

```

7. The variable `WTKG3` has measurements of weight in 10s of grams (i.e. `WTKG3` divided by 100 gives the weight in kilogram). 

### 8. Use `ggplot2` to draw a scatterplot of weight (`WTKG3`) by height (new `height` variable). Facet by gender and comment.
It seems like the spread of Weight/Height ratios for men is a little more variable, with quite a few values visable on the right side of the grouping. In general, it seems that the two variables are positively correlated and that increases in height tend to be matched with increases in weight. Men, in general, tend to weight more and be taller as well. 


```{r, cache = TRUE, warning = FALSE}
iowa %>% 
  ggplot(aes(x=WTKG3/100, y=height)) +
  geom_point() +
  facet_wrap(SEX1~.)

```



Due date: the homework is due a week from now on Thursday. 

For the submission: submit your solution in an R Markdown file and (just for insurance) submit the corresponding html/word file with it. 
