---
title: 'Stat 579 - Homework #7'
date: "10/17/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Human Development Index

The United Nations Development Programme publishes an annual report on human development across the globe. An interactive tool to visualize some of the data is available at  http://hdr.undp.org/en/data 



1. Download the RMarkdown file with these homework instructions to use as a template for your work.
Make sure to replace "Your Name" in the YAML with your name.
2. Download the data for 2018 from the left side tab  stating [Download 2018 Human Development Data Bank](http://hdr.undp.org/sites/default/files/2018_all_indicators.xlsx). This will lead you to an Excel document. Open it and comment on the structure you find in the `Data' sheet. Comment on the overall structure in the context of "long" versus "wide" data.

The data sheet has 5 categorical variables and numerical values in columns describing dates where for a certain country and category, we see data over all the years in the dataset in each observation.
We can see that the columns with years is formatted as wide data since for each observation we have columns for each year. Then the variables `country`, `dimension`, and `indicator name` is formatted as long data since there is an observation for each category noting the type of category and the country being considered. 

3. There is an R package available online (on CRAN) that allows to read Excel files. Find the package, (install it if necessary), load it  and read the `Data' sheet "2018_all_indicators.xlsx" into R (make use of the available parameters). Compare the result in R with what is visible in Excel. Keep track of and comment on all steps in the process. 
For the write-up assume, that the Excel file is in the same folder as the homework Rmd file. Also assume, that both the TA and I have  updated versions of all packages you use, i.e. only load packages but do not install any in the code.

```{r}

#Load in our packages
library("dplyr")
library("tidyr")
library("ggplot2")
library("readxl")

#Read our excel sheet into a data frame
HDD <- read_excel("2018_all_indicators.xlsx")
```
4. Bring the data into a long form. What setting do you use for missing values? How many indicators are in the data? Use `ggplot2` to show a barchart.
```{r}
long_HDD <- HDD %>% 
  gather(key = Date, value = Value, `1990`:`9999`, na.rm = TRUE)

length(unique(long_HDD$indicator_name))

long_HDD %>% 
  ggplot(aes(x=indicator_name)) +
  geom_bar() +
  coord_flip() +
  theme(axis.text.y = element_text(size = 3))
```

We use the setting `na.rm = TRUE` for missing values since the values in `Values` was the only reported value for this data set, which means missing values give us no particular information. We see that there are 156 different indicators in the data. 

5. Two of the indicators are called `Human Development Index (HDI), male` and `Human Development Index (HDI), female`. Comment on this from a tidy data perspective.

From a tidy data perspective, we wouldn't consider having both of the indicators `Human Development Index (HDI), male` and `Human Development Index (HDI), female` clean because the indicators contain multiple variables stored in one column as it contains a broad category index as well as a gender. Therefore we might consider having a new column specifying the gender(s) we are considering. 

6. Use `tidyr` and `dplyr` functionality to get the data set into a format to be able to recreate the plot below (from the United Nations website) in ggplot. Use a classification of HDI of very high for [0.8,1], high for [0.7, .8), medium for [.55, .7) and low below .55), color lines by the last available year. 1pt of extra for using a better color scheme than is shown below. 

```{r}


long_HDD %>% 
  filter(indicator_name == "Human Development Index (HDI)",
         Date != 9999) %>% 
  mutate(Interval = ifelse(Value <= 1 & Value >= 0.8, '[0.8,1]', 
                 ifelse(Value >= 0.7 & Value < 0.8, '[0.7,0.8)', 
                 ifelse(Value >= 0.55 & Value < 0.7, '[0.55,0.7)', '[0,0.55)')))) %>% 
  ggplot(aes(x = Date, y = Value, group = iso3, colour = Interval)) +
  geom_line() +
  scale_color_manual(values = c("Red","Blue","Dark Green","Purple")) +
  theme(axis.text.x = element_text(size = 4)) 


```

Due date: please refer to the website and Canvas for the due date. 

For the submission: submit your solution in an R Markdown file and (just for insurance) submit the corresponding html/word file with it. 
