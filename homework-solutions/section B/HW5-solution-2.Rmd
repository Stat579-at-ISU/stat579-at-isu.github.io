---
title: 'Stat 579 - Homework #5 - Section B'
date: "10/1/2019"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Behavioral Risk Factor Surveillance System - Again

We are again looking at the data from the
Behavioral Risk Factor Surveillance System (BRFSS).

A subset of the data concentrating on Iowa with records for 2016 is given at
```{r}
url <- "https://raw.githubusercontent.com/Stat579-at-ISU/stat579-at-isu.github.io/master/homework/data/brfss-iowa-2018.csv"
```

The following code reads the data into your R session:
```{r, cache = TRUE, warning = FALSE}
iowa <- read.csv(url)
library(tidyverse)
```
| HEIGHT3 value  |  Interpretation    |
|:- |:- |
| 200 - 711 | Height (ft/inches), i.e. 410 is 4 feet, 10 inches	|
| 7777 |	Don't know/Not sure	|
| 9000 - 9998 |	Height (meters/centimeters), where the first 9 indicates that the measurement was metric, 9165 is 1 meter 65 cm |
| 9999	| Refused |
| BLANK |	Not asked or Missing |

The overall goal is to introduce a new variable `height` that corresponds to reported height in centimeters [cm].

3. Sketch out a way to derive a new variable `height` that represents the values in `HEIGHT3` in centimeters and properly encodes any unavailable information as missing values (`NA`).
Implement your transformation. For your convenience: 1 ft equals 30.48 cm, 1 inch equals 2.54 cm. 1 m equals 100 cm.

```{r, cache = TRUE, warning = FALSE}

iowa$height<- iowa$HEIGHT3
iowa<-iowa%>% mutate(height = replace(height, height %in% c(7777,9999),NA)) 
iowa<-iowa%>% mutate(height = ifelse(height>9000, (height-9000), height)) 
iowa<-iowa%>% mutate(height = ifelse(height %in% (200:711), (((height%/%100)*30.48) +((height%%100)*2.54)), height)) 
iowa%>%ggplot(aes(x=height))+geom_histogram(binwidth=4.5)
summary(iowa$height)
```
#For this problem, I like to take it one step at a time. Much easier for me to understand. I first replaced the 7777 and 9999 values and then used ifelse statement for the values >9000 and another ifelse statement for values that were within 200:711. I think the graph turned out nice. We still dont know the differences between males/females in this histogram but you can see 2 distinct peaks which may suggest genders. This observation could also just be due to the bandwidth that I set. Be cautious of that as well - mainly just a note for myself when I look back at this assignment for when studying for the midterm!



4. How  many missing values does the variable `height` have? 

```{r, cache = TRUE, warning = FALSE}
summary(iowa$height)
```
#There are a total of 252 NA's or "missing values".



5. What is the average height among respondents of the survey? among men? among women? Does the result make sense? Comment.

```{r, cache = TRUE, warning = FALSE}
summary(iowa$height)

height_male = iowa%>%
  filter(SEX1==1)
summary(height_male$height)

height_female = iowa%>%
  filter(SEX1==2)
summary(height_female$height)

```

#The mean average height among the respondents of the survey is: 171.23 cm. 
#Among males the mean average height is: 178.82 cm.
#Among females the mean average height is: 164.3 cm.

#These results are to be expected. We know from the last homework, as well as gender studies, that males are on average taller than females. The data only confirms this. The only surprising point is the minimum height for men is lower than women. But that is why we use means and not minimums in statistics! Looking closer at the heights specifically, these heights do not look deciving and should be okay to use :)


6. Plot a histogram of `height`, facet by gender such that the histograms are on top of each other. Choose an appropriate bin width and comment on the resulting plot. 


```{r, cache = TRUE, warning = FALSE}
iowa%>%
  filter(SEX1 %in% (1:2))%>%
ggplot(aes(x=height, fill=factor(SEX1))) + geom_histogram(binwidth=4.5) + facet_grid(SEX1~ .)
```
# This graph does a better job showing the difference between males and females. As you can see, the males "1" are slightly taller on average than females "2". Another thing you may be able to mention from this graph is that there is less distribution amoungst the females. For example, the data for females is less skewed and more like a bell curve! Remembering from the last assignment, there was a large, short, outlier in the


7. The variable `WTKG3` has measurements of weight in 10s of grams (i.e. `WTKG3` divided by 100 gives the weight in kilogram).
#Professor said this isnt a question in class.

8. Use `ggplot2` to draw a scatterplot of weight (`WTKG3`) by height (new `height` variable). Facet by gender and comment.

```{r, cache = TRUE, warning = FALSE}
iowa%>%
  filter(SEX1 %in% (1:2))%>%
  ggplot(aes(x=WTKG3/100, y=height, color=factor(SEX1)))+geom_point() + facet_grid(SEX1~ .)
```
# Lastly, we have a scatterplot graph. This graph shows us that males are both heavier and taller on average than females. Again, we can see a slight tail in the males and the females have a more normally distributed dataset. For this questionaire, we can say that the females were more homogeneous and the males were more heterogeneous. 


Due date: the homework is due a week from now on Tuesday. 

For the submission: submit your solution in an R Markdown file and (just for insurance) submit the corresponding html/word file with it. 
