---
title: 'Stat 579 - Homework #6 - Section B'
date: "10/8/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Flying etiquette

```{r}
fly <- read.csv("https://raw.githubusercontent.com/fivethirtyeight/data/master/flying-etiquette-survey/flying-etiquette.csv")
```

```{r}
fly$Age <- factor(fly$Age, levels=c("18-29", "30-44", "45-60", "> 60", ""))
fly$Household.Income <- factor(fly$Household.Income, levels = c("$0 - $24,999","$25,000 - $49,999", "$50,000 - $99,999", "$100,000 - $149,999", "150000", ""))
fly$Education <- factor(fly$Education, levels = c("Less than high school degree", "High school degree", "Some college or Associate degree", "Bachelor degree",  "Graduate degree", ""))
```


## 2

```{r}
library(tidyverse)
library(ggplot2)
fly$How.often.do.you.travel.by.plane.<- factor(fly$How.often.do.you.travel.by.plane., levels = c("Never","Once a year or less","Once a month or less" ,"A few times per month","A few times per week","Every day"))
fly%>%
  ggplot(aes(x=How.often.do.you.travel.by.plane.))+geom_bar()
```

Most people travel by plane once a year or less. About 200 participants take flight once a month or less. The third biggest class is who never travels by plane.

```{r}
flynew <- filter(fly,fly$How.often.do.you.travel.by.plane.!="Never") 
dim(flynew)
```

The data set has 874 records now.

## 3

```{r}
flynew<- flynew %>% mutate(
  Education = replace(Education,Education=="", NA))
flynew<- flynew %>% mutate(  
  Age = replace(Age, Age=="", NA))
flynew<- flynew %>% mutate(  
  Household.Income = replace(Household.Income, Household.Income=="", NA))
sum(is.na(flynew$Education))
sum(is.na(flynew$Age))
sum(is.na(flynew$Household.Income))
sum(is.na(flynew$Household.Income)|is.na(flynew$Education)|is.na(flynew$Age))
```

874-37=837 Education records do not have missing values,  874-31=843 Age records do not have missing values, 874-176=698 Household.Income records do not have missing values. Overall, 696 responses have no missing values in any of the three variables.


## 4 
```{r, fig.width=8, fig.height=3, message=FALSE}
library(ggplot2)
fly$Education = with(fly, factor(Education, levels = rev(levels(Education))))

ggplot(data = fly, aes(x = 1)) + 
  geom_bar(aes(fill=Education), position="fill") + 
  coord_flip() +
  theme(legend.position="bottom") +
  scale_fill_brewer() + 
  xlab("Ratio") 
```

It seems that this chart wants to compare the influence of education on probability of taking flight . One potential problem is that it drops off the information of frenquency. We cannot tell the difference between "once a year or less" and "everyday" from this chart.

## 5
```{r}
colnames(flynew)[colnames(flynew)=="In.general..is.itrude.to.bring.a.baby.on.a.plane."] <- "baby.on.plane."
levels(flynew$baby.on.plane.)
levels(flynew$baby.on.plane.) = c('Not answered', levels(flynew$baby.on.plane.)[2:4])
flynew$baby.on.plane. <- factor(flynew$baby.on.plane.,levels = c( "No, not at all rude", "Yes, somewhat rude", "Yes, very rude","Not answered" ))
flynew%>% ggplot(aes(x=baby.on.plane.))+geom_bar()
```

The variable `baby.on.plane` has 4 levels: " ","No, not at all rude ","Yes, somewhat rude","Yes, very rude ".  Put the level "Not answered" last. Almost 600 people think it is not rude to bring a baby on the plane. Three times as high as those who thinks it is very rude. 


## 6
```{r}
flynew%>%
  filter(Gender!="",Do.you.have.any.children.under.18.!="")%>%
  ggplot(aes(x=baby.on.plane., fill=Gender)) +geom_bar(position = "stack")+facet_wrap(~Do.you.have.any.children.under.18.)
```

I drop all the missing values for Gender. The bar plot shows that women have higher tolerance for baby on the plane, while more males think it is very rude to bring a baby on the plane. Besides, people who have a child under 18 tends to have nicer attitude towards baby on the plane.It is more likely for people to tolerate a baby and choose not rude if they have children under 18. 



