---
title: 'Stat 579 - Homework #7 - Section B'
date: "10/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=F, warning=F}
library(tidyverse)
library(dplyr)
library(ggplot2)
```

## Chick Weights

For this assignment we will use the data set `ChickWeight`. You need to load the data in R using `data(ChickWeight)`.
The `ChickWeight` data frame has 578 rows and 4 columns from an experiment on the effect of diet on early growth of chicks. Use `?ChickWeight` to get more information on every one of the variables.

1. Download the RMarkdown file with these homework instructions to use as a template for your work.
Make sure to replace "Your Name" in the YAML with your name.

2.  Each chick should have twelve weight measurements. Use the `dplyr` package to identify how many chicks have a complete set of weight measurements and how many measurements there are in the incomplete cases. Extract a subset of the data for all chicks with complete information and name the data set `complete`. (Hint: you might want to use `mutate` to introduce a helper variable consisting of the number of observations) 
```{r}
data(ChickWeight)
```

Number of chicks with a complete set of weight measurements(12):
```{r}
ChickWeight %>%
  group_by(Chick) %>%
  summarise(count=n()) %>%
  filter(count == 12) %>%
  nrow()
```

Number of measurements in the incomplete cases for chickens:

```{r}
ChickWeight %>%
  group_by(Chick) %>%
  summarise(count=n()) %>%
  filter(count != 12)
```

The complete dataset is as below:
```{r}
complete_chicks = ChickWeight %>%
  group_by(Chick) %>%
  summarise(count=n()) %>%
  filter(count == 12) %>%
  select(Chick)

complete = ChickWeight %>%
  filter(Chick %in% complete_chicks$Chick)
```



3. In the `complete` data set introduce a new variable that measures the current weight difference compared to day 0. Name this variable `weightgain`.   

```{r}
complete = complete %>%
  group_by(Chick) %>%
  mutate(weightgain = weight-weight[1]) %>%
  ungroup()
```


4.  Using the `ggplot2` package create  side-by-side boxplots of `weightgain` by `Diet` for day 21. Describe the relationship in 2-3 sentences. 
Change the order of the categories in the `Diet` variable such that the boxplots are ordered by median `weightgain`.

side-by-side boxplots of weightgain by Diet for day 21 is as below:
```{r}
complete %>%
  filter(Time == 21) %>%
  ggplot(aes(x=Diet, y=weightgain))+
  geom_boxplot(aes(fill=Diet))
```

*Comment:*
first of all the Diet seems to be important factor for the response variable weightgain
because, they seem different according to either the mean or their median. But the 
variability of them (IQR) seems to be the same for all.
Diet 3 seems to have the most impct on the weightgainand the diet 1 seems to have the
lowest influence. But in order to make sure we need to conduct t-test or a non-parametric
based on whether the assumptions hold or not.

After changing the order:
```{r}
complete %>%
  filter(Time == 21) %>%
  mutate(Diet = reorder(Diet, weightgain, FUN = median, na.rm = T)) %>%
  ggplot(aes(x=Diet, y=weightgain))+
  geom_boxplot(aes(fill=Diet))
```



5. Draw a plot of weight by time. Facet by `Diet`. Use a point layer and also draw one line for each `Chick` (use `geom_line` and specify `group = Chick`). Color by `Diet`.  <br>
Comment on the plot in  2-3 sentences. 

```{r}
complete %>%
  ggplot(aes(x=Time, y=weight)) +
  geom_point(aes(col=Diet))+
  geom_line(aes(group=Chick, col=Diet))+
  facet_grid(~Diet)+
  theme_classic()
```

*Comment:*
This plot shows that the by time, the weight of the chickens will be increased
for all diets. Again we can see that the third diet has the the steepest slope, suggesting that it has the most impact on the chicken respect to the amount of weight increased.
Secondly, we can see that the variation between different chickens at the beginning is low, which means that diets do not affect suddenly, but as time goes by, they show more difference.(Increasing variation during the time)
(At the end, it worths to mention that in summary, it shows a positive realtionship with time)


6. Comment on the two resulting plots below. Which plot best describes the effect of the diets on the chicks?
  a. Select the  `Chick` with the maximum weight at `Time` 21 for each of the diets. Redraw the previous plot with only these 4 chicks (and don't facet).
  
```{r}
complete %>%
  group_by(Diet) %>%
  filter(Time == 21, weight == max(weight)) %>%
  select()


complete %>%
  filter(Chick %in% c(7, 21, 35, 48)) %>%
  ggplot(aes(x=Time, y=weight)) +
  geom_point(aes(col=Diet))+
  geom_line(aes(col=Diet))+
  scale_y_continuous(breaks = seq(50, 400, 50))+
  scale_x_continuous(breaks = unique(complete$Time))+
  theme_classic()
```

*Comment:*
It shows that the diet 3 led to the largest weight among all chickens (best of the best at T=21). At the beginning, they are pretty similar, but the effect shows up after a few days.
On the other hand, we have the first diet with the minimum increase in weight after 21 days.
Also, we can see that the diet 2 was ahead until T=14, but diet 3 will take its place.



  
  b. Compute average daily weights under each Diet and redraw the plot (using the same structure and aesthetics as before).<br>
  
```{r}
complete %>%
  group_by(Diet, Time) %>%
  summarise(average_weight = mean(weight)) %>%
  ggplot(aes(x=Time, y=average_weight))+
  geom_point(aes(col=Diet))+
  geom_line(aes(col=Diet))+
  scale_y_continuous(breaks = seq(50, 300, 50))+
  scale_x_continuous(breaks = unique(complete$Time))+
  theme_classic()
```

*Comment:*
The avergae plot seem more smooth, now we can see that diet 1 is the minimum all the time, but again diet 3 surpasses the diet 4 at time point 14. (and positive relationship as before)


*choosing the best plot:*
Since we are looking for the overall relationship, it might not be a good idea to rely on only one chicken measurement, but to consider all together. Because in that case, the effect might not be only due to the treatment, but also is can be confounded with the effect of the chicken itself. Maybe the maximum weight was obtained by a chicken with certain condition, therefore, taking the average not only smoothes the plot and easier to interprete, but also makes the interpretation more reliable.



Due date: please refer to the website and Canvas for the due date. 

For the submission: submit your solution in an R Markdown file and (just for insurance) submit the corresponding html/word file with it. 
